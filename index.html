<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Yellow Test</title>
</head>

<body class="chat-open">
    <button type="button" onClick={window.showBot}>Click to show</button>
    <button type="button" onClick={window.hideBot}>Click to hide</button>
    <script type="text/javascript">
        function runChatbot() {
            const bot_id = "x1670310721002"
            window.ymConfig = {
                "bot": bot_id,
                "host": "https://r2.cloud.yellow.ai",
                "payload": {
                    "zendesk_jwt_token": "",
                    "flip_jwt_token": "",
                    "user_id_flip": "",
                }
            }; (function () { var w = window, ic = w.YellowMessenger; if ("function" === typeof ic) ic("reattach_activator"), ic("update", ymConfig); else { var d = document, i = function () { i.c(arguments) }; function l() { var e = d.createElement("script"); e.type = "text/javascript", e.async = !0, e.src = "https://cdn.yellowmessenger.com/plugin/widget-v2/latest/dist/main.min.js"; var t = d.getElementsByTagName("script")[0]; t.parentNode.insertBefore(e, t) } i.q = [], i.c = function (e) { i.q.push(e) }, w.YellowMessenger = i, w.attachEvent ? w.attachEvent("onload", l) : w.addEventListener("load", l, !1) } })();
            window.addEventListener('message', function (eventData) {
                eventData = JSON.parse(eventData.data)
                console.log(eventData, "eventData"); //Check incoming eventData
                // as flag when zendesk webview timeout triggered
                if (eventData.data && eventData.data.data && eventData.data.data.code == "reload-chatbot-widget") {
                    reloadBot()
                }
                // if (eventData.event_code == "message-received") {
                //     if (eventData.data.includes("Baik Kak, kami tutup ya percakapan") || eventData.data.includes("Alright, we already closed your chat") || eventData.data.includes("Alright, we will close your chat")) {
                //         reloadBot()
                //     }
                // }    
            })
            function reloadBot() {
                window.YellowMessengerPlugin.init(
                    //     {
                    //     ymAuthenticationToken: 'eGrianoABC123'
                    // }
                );
                setTimeout(() => {
                    document.getElementById("ymDivBar").style.display = "none"
                    window.YellowMessengerPlugin.openBot()
                }, 1000);
            }
        }
        runChatbot()
        function showBot() {
          window.YellowMessengerPlugin.show()
        }

        function hideBot() {
          window.YellowMessengerPlugin.closeBot()
          window.YellowMessengerPlugin.hide()
        }
        setTimeout(() => {
            // window.YellowMessengerPlugin.init({
            //     ymAuthenticationToken: 'eGrianoABC123'
            // });
            window.YellowMessengerPlugin.openBot()
        }, 1000)
    </script>
</body>

</html>
